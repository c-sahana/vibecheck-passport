<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>ğŸ›‚ Mood Check-In | VibeCheck Passport</title>
    <link rel="stylesheet" href="style.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Quicksand:wght@500;700&display=swap"
      rel="stylesheet"
    />
    <style>
      @keyframes bounce {
        0%,
        100% {
          transform: translateY(0);
        }
        50% {
          transform: translateY(-5px);
        }
      }
      .plane {
        display: inline-block;
        animation: bounce 1s infinite;
      }

      /* âœ¨ new style for vibe line */
      .vibe-line {
        font-size: 1.1rem;
        margin-top: 0.3rem;
        color: #5a2fd1;
        font-weight: 600;
      }

      /* ğŸ’Œ subtle emphasis for â€œdrop your feelsâ€ line */
      .drop-line {
        font-size: 1.1rem;
        margin-top: 0.3rem;
        color: #ff5e99;
        font-weight: 600;
      }

      .hint {
        font-size: 1rem;
        color: #555;
        margin-top: 0.8rem;
        font-style: italic;
      }
    </style>
  </head>
  <body>
    <!-- ğŸŒ NAVBAR -->
    <nav class="navbar">
      <h2 class="logo">ğŸ« VibeCheck Passport</h2>
      <div class="nav-links">
        <a href="home.html">ğŸ  Home</a>
        <a href="main.html" class="active">ğŸ›‚ Mood Check-In</a>
        <a href="passport.html">ğŸ“– Passport</a>
        <a href="badgeboard.html">ğŸ¯ Badge Board</a>
      </div>
    </nav>

    <!-- ğŸ›‚ MOOD CHECK SECTION -->
    <div class="container">
      <h1>ğŸ›‚ Mood Check-In</h1>

      <!-- ğŸ‘‹ Greeting will fill in user name -->
      <p id="greeting" style="font-size: 1.3rem; font-weight: bold"></p>

      <br />

      <!-- âœ¨ New creative text lines -->
      <p class="vibe-line">
        ğŸŒ Your mood will decide which emotional country youâ€™ll fly now.
      </p>
      <p class="drop-line">
        ğŸ“– Drop your feels, weâ€™ll stamp your passport âœˆï¸ğŸ’Œ
      </p>

      <p class="hint">ğŸ’¡ Hint: Your mood is your ticket â€” be honest!</p>

      <div class="mood-input">
        <textarea
          id="mood"
          placeholder="Write your current mood here (e.g. â€˜I feel excited but nervousâ€™) âœï¸"
        ></textarea>
        <button onclick="submitMood()">
          Submit Mood <span class="plane">âœˆï¸</span>
        </button>
      </div>

      <div id="vibe-response" style="display: none"></div>
    </div>

    <script>
      // ğŸ‘‹ show greeting with username
      const user = localStorage.getItem("username") || "Traveler";
      document.getElementById(
        "greeting"
      ).innerText = `Hey ${user}, how are you feeling today?`;

      async function submitMood() {
        const mood = document.getElementById("mood").value.trim();
        const vibeResponse = document.getElementById("vibe-response");

        if (!mood) {
          vibeResponse.style.display = "block";
          vibeResponse.innerText =
            "âš ï¸ Please enter how you feel before checking in!";
          return;
        }

        vibeResponse.style.display = "block";
        vibeResponse.innerText =
          "ğŸ›‚ Processing your vibe... stamping your passport...";

        try {
          const res = await fetch("/vibecheck", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ mood }),
          });
          const data = await res.json();
          if (data.country && data.question) {
            // save response neatly for customs page
            localStorage.setItem(
              "lastReply",
              `${data.country} Customs question: ${data.question}`
            );
            window.location.href = "customs.html";
          } else {
            vibeResponse.innerText = "âŒ No vibe detected. Try again!";
          }
        } catch (err) {
          console.error(err);
          vibeResponse.innerText = "ğŸ’¥ Something went wrong. Try again!";
        }
      }
    </script>
  </body>
</html>
